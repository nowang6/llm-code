[2024-03-19 14:41:56,232] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-19 14:41:56,463] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-03-19 14:41:56,474] [INFO] [runner.py:568:main] cmd = /home/niwang/miniconda3/envs/longqlora/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None dxm_llm_main.py --train_mode pretrain --model_name_or_path TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T --save_name out/ --data_path data-out --epochs 1 --per_device_train_batch_size 4 --max_length 2048 --ds_zero_stage 2 --log_steps 2 --save_steps 40 --gradient_checkpointing
[2024-03-19 14:41:57,896] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-19 14:41:58,106] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2024-03-19 14:41:58,106] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=2, node_rank=0
[2024-03-19 14:41:58,106] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2024-03-19 14:41:58,106] [INFO] [launch.py:163:main] dist_world_size=2
[2024-03-19 14:41:58,106] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2024-03-19 14:41:58,107] [INFO] [launch.py:253:main] process 15016 spawned with command: ['/home/niwang/miniconda3/envs/longqlora/bin/python', '-u', 'dxm_llm_main.py', '--local_rank=0', '--train_mode', 'pretrain', '--model_name_or_path', 'TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T', '--save_name', 'out/', '--data_path', 'data-out', '--epochs', '1', '--per_device_train_batch_size', '4', '--max_length', '2048', '--ds_zero_stage', '2', '--log_steps', '2', '--save_steps', '40', '--gradient_checkpointing']
[2024-03-19 14:41:58,107] [INFO] [launch.py:253:main] process 15017 spawned with command: ['/home/niwang/miniconda3/envs/longqlora/bin/python', '-u', 'dxm_llm_main.py', '--local_rank=1', '--train_mode', 'pretrain', '--model_name_or_path', 'TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T', '--save_name', 'out/', '--data_path', 'data-out', '--epochs', '1', '--per_device_train_batch_size', '4', '--max_length', '2048', '--ds_zero_stage', '2', '--log_steps', '2', '--save_steps', '40', '--gradient_checkpointing']
[2024-03-19 14:41:59,553] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-19 14:41:59,604] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-03-19 14:42:00 INFO: [rank0] ============== 参数 ====================
2024-03-19 14:42:00 INFO: [rank0]   data_path = data-out
2024-03-19 14:42:00 INFO: [rank0]   model_name_or_path = TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T
2024-03-19 14:42:00 INFO: [rank0]   save_name = out/
2024-03-19 14:42:00 INFO: [rank0]   learning_rate = 5e-05
2024-03-19 14:42:00 INFO: [rank0]   weight_decay = 0.01
2024-03-19 14:42:00 INFO: [rank0]   num_warmup_steps = 0
2024-03-19 14:42:00 INFO: [rank0]   seed = 1234
2024-03-19 14:42:00 INFO: [rank0]   train_mode = pretrain
2024-03-19 14:42:00 INFO: [rank0]   epochs = 1
2024-03-19 14:42:00 INFO: [rank0]   total_num_steps = 100000
2024-03-19 14:42:00 INFO: [rank0]   gradient_accumulation_steps = 1
2024-03-19 14:42:00 INFO: [rank0]   per_device_train_batch_size = 4
2024-03-19 14:42:00 INFO: [rank0]   max_length = 2048
2024-03-19 14:42:00 INFO: [rank0]   gradient_checkpointing = True
2024-03-19 14:42:00 INFO: [rank0]   log_steps = 2
2024-03-19 14:42:00 INFO: [rank0]   save_steps = 40
2024-03-19 14:42:00 INFO: [rank0]   ds_offload_cpu = False
2024-03-19 14:42:00 INFO: [rank0]   ds_zero_stage = 2
2024-03-19 14:42:00 INFO: [rank0]   ds_steps_per_print = 100
2024-03-19 14:42:00 INFO: [rank0]   local_rank = 0
2024-03-19 14:42:00 INFO: [rank0]   global_rank = -1
2024-03-19 14:42:00 INFO: [rank0]   deepspeed = False
2024-03-19 14:42:00 INFO: [rank0]   deepspeed_config = None
2024-03-19 14:42:00 INFO: [rank0]   deepscale = False
2024-03-19 14:42:00 INFO: [rank0]   deepscale_config = None
2024-03-19 14:42:00 INFO: [rank0] =======================================
local_rank=0 device=cuda:0
[2024-03-19 14:42:00,106] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-19 14:42:00,106] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
local_rank=1 device=cuda:1
[2024-03-19 14:42:00,131] [INFO] [comm.py:637:init_distributed] cdb=None
global rank：1  local rank: 1
global rank：0  local rank: 0
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T/resolve/main/tokenizer_config.json (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/niwang/code/llm-code/dxm_llm_main.py", line 205, in <module>
    main()
  File "/home/niwang/code/llm-code/dxm_llm_main.py", line 138, in main
    dataloader_dict = get_dataloader_common(args)
  File "/home/niwang/code/llm-code/model_hook.py", line 59, in get_dataloader_common
    tokenizer = get_tokenizer(args)
  File "/home/niwang/code/llm-code/model_hook.py", line 20, in get_tokenizer
    tokenizer = LlamaTokenizer.from_pretrained(args.model_name_or_path)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 1952, in from_pretrained
    resolved_config_file = cached_file(
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/transformers/utils/hub.py", line 385, in cached_file
    resolved_file = hf_hub_download(
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1261, in hf_hub_download
    metadata = get_hf_file_metadata(
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1667, in get_hf_file_metadata
    r = _request_wrapper(
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 385, in _request_wrapper
    response = _request_wrapper(
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 408, in _request_wrapper
    response = get_session().request(method=method, url=url, **params)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 67, in send
    return super().send(request, *args, **kwargs)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/requests/adapters.py", line 517, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T/resolve/main/tokenizer_config.json (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))"), '(Request ID: 767222ad-d8f7-40d8-ae8e-bcfb66670008)')
2024-03-19 14:42:00 INFO: [rank0] ==================== Loading dataset =================
/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 12, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2024-03-19 14:42:00 INFO: [rank0] Dataset Loaded: data-out costtime=0.00s
2024-03-19 14:42:00 INFO: [rank0]    Num samples: 2431
2024-03-19 14:42:00 INFO: [rank0]    Num Tokens: 0.00B
2024-03-19 14:42:00 INFO: [rank0]    Total Steps: 304
2024-03-19 14:42:00 INFO: [rank0] =================== Loading Model =====================
2024-03-19 14:42:00 INFO: [rank0] loading model from TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T
[2024-03-19 14:42:01,117] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 15016
[2024-03-19 14:42:01,156] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 15017
[2024-03-19 14:42:01,156] [ERROR] [launch.py:322:sigkill_handler] ['/home/niwang/miniconda3/envs/longqlora/bin/python', '-u', 'dxm_llm_main.py', '--local_rank=1', '--train_mode', 'pretrain', '--model_name_or_path', 'TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T', '--save_name', 'out/', '--data_path', 'data-out', '--epochs', '1', '--per_device_train_batch_size', '4', '--max_length', '2048', '--ds_zero_stage', '2', '--log_steps', '2', '--save_steps', '40', '--gradient_checkpointing'] exits with return code = 1
[2024-03-19 14:43:59,544] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-19 14:43:59,774] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-03-19 14:43:59,785] [INFO] [runner.py:568:main] cmd = /home/niwang/miniconda3/envs/longqlora/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None dxm_llm_main.py --train_mode pretrain --model_name_or_path TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T --save_name out/ --data_path data-out --epochs 1 --per_device_train_batch_size 4 --max_length 2048 --ds_zero_stage 2 --log_steps 2 --save_steps 40 --gradient_checkpointing
[2024-03-19 14:44:01,210] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-19 14:44:01,420] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2024-03-19 14:44:01,420] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=2, node_rank=0
[2024-03-19 14:44:01,420] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2024-03-19 14:44:01,420] [INFO] [launch.py:163:main] dist_world_size=2
[2024-03-19 14:44:01,420] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2024-03-19 14:44:01,421] [INFO] [launch.py:253:main] process 15438 spawned with command: ['/home/niwang/miniconda3/envs/longqlora/bin/python', '-u', 'dxm_llm_main.py', '--local_rank=0', '--train_mode', 'pretrain', '--model_name_or_path', 'TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T', '--save_name', 'out/', '--data_path', 'data-out', '--epochs', '1', '--per_device_train_batch_size', '4', '--max_length', '2048', '--ds_zero_stage', '2', '--log_steps', '2', '--save_steps', '40', '--gradient_checkpointing']
[2024-03-19 14:44:01,421] [INFO] [launch.py:253:main] process 15439 spawned with command: ['/home/niwang/miniconda3/envs/longqlora/bin/python', '-u', 'dxm_llm_main.py', '--local_rank=1', '--train_mode', 'pretrain', '--model_name_or_path', 'TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T', '--save_name', 'out/', '--data_path', 'data-out', '--epochs', '1', '--per_device_train_batch_size', '4', '--max_length', '2048', '--ds_zero_stage', '2', '--log_steps', '2', '--save_steps', '40', '--gradient_checkpointing']
[2024-03-19 14:44:02,932] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-19 14:44:02,936] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-03-19 14:44:03 INFO: [rank0] ============== 参数 ====================
2024-03-19 14:44:03 INFO: [rank0]   data_path = data-out
2024-03-19 14:44:03 INFO: [rank0]   model_name_or_path = TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T
2024-03-19 14:44:03 INFO: [rank0]   save_name = out/
2024-03-19 14:44:03 INFO: [rank0]   learning_rate = 5e-05
2024-03-19 14:44:03 INFO: [rank0]   weight_decay = 0.01
2024-03-19 14:44:03 INFO: [rank0]   num_warmup_steps = 0
2024-03-19 14:44:03 INFO: [rank0]   seed = 1234
2024-03-19 14:44:03 INFO: [rank0]   train_mode = pretrain
2024-03-19 14:44:03 INFO: [rank0]   epochs = 1
2024-03-19 14:44:03 INFO: [rank0]   total_num_steps = 100000
2024-03-19 14:44:03 INFO: [rank0]   gradient_accumulation_steps = 1
2024-03-19 14:44:03 INFO: [rank0]   per_device_train_batch_size = 4
2024-03-19 14:44:03 INFO: [rank0]   max_length = 2048
2024-03-19 14:44:03 INFO: [rank0]   gradient_checkpointing = True
2024-03-19 14:44:03 INFO: [rank0]   log_steps = 2
2024-03-19 14:44:03 INFO: [rank0]   save_steps = 40
2024-03-19 14:44:03 INFO: [rank0]   ds_offload_cpu = False
2024-03-19 14:44:03 INFO: [rank0]   ds_zero_stage = 2
2024-03-19 14:44:03 INFO: [rank0]   ds_steps_per_print = 100
2024-03-19 14:44:03 INFO: [rank0]   local_rank = 0
2024-03-19 14:44:03 INFO: [rank0]   global_rank = -1
2024-03-19 14:44:03 INFO: [rank0]   deepspeed = False
2024-03-19 14:44:03 INFO: [rank0]   deepspeed_config = None
2024-03-19 14:44:03 INFO: [rank0]   deepscale = False
2024-03-19 14:44:03 INFO: [rank0]   deepscale_config = None
2024-03-19 14:44:03 INFO: [rank0] =======================================
local_rank=0 device=cuda:0
[2024-03-19 14:44:03,418] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-19 14:44:03,418] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
local_rank=1 device=cuda:1
[2024-03-19 14:44:03,478] [INFO] [comm.py:637:init_distributed] cdb=None
global rank：1  local rank: 1
global rank：0  local rank: 0
2024-03-19 14:44:04 INFO: [rank0] ==================== Loading dataset =================
/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 12, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 12, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2024-03-19 14:44:04 INFO: [rank0] Dataset Loaded: data-out costtime=0.00s
2024-03-19 14:44:04 INFO: [rank0]    Num samples: 2431
2024-03-19 14:44:04 INFO: [rank0]    Num Tokens: 0.00B
2024-03-19 14:44:04 INFO: [rank0]    Total Steps: 304
2024-03-19 14:44:04 INFO: [rank0] =================== Loading Model =====================
2024-03-19 14:44:04 INFO: [rank0] loading model from TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T
2024-03-19 14:44:05 INFO: [rank0] model loaded. costtime=1.84s
2024-03-19 14:44:05 INFO: [rank0] model = LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 2048)
    (layers): ModuleList(
      (0-21): 22 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
          (k_proj): Linear(in_features=2048, out_features=256, bias=False)
          (v_proj): Linear(in_features=2048, out_features=256, bias=False)
          (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=2048, out_features=5632, bias=False)
          (up_proj): Linear(in_features=2048, out_features=5632, bias=False)
          (down_proj): Linear(in_features=5632, out_features=2048, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=2048, out_features=32000, bias=False)
)
2024-03-19 14:44:05 INFO: [rank0] Finally total_params: 1100048384 trainable_params: 1100048384 ratio 100.0000% 
[2024-03-19 14:44:05,860] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-03-19 14:44:07,400] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /home/niwang/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Using /home/niwang/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/niwang/.cache/torch_extensions/py310_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.03598833084106445 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 0.10128903388977051 seconds
[2024-03-19 14:44:07,748] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-03-19 14:44:07,749] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-03-19 14:44:07,752] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-03-19 14:44:07,752] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-03-19 14:44:07,752] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2024-03-19 14:44:07,752] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500,000,000
[2024-03-19 14:44:07,752] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500,000,000
[2024-03-19 14:44:07,752] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2024-03-19 14:44:07,752] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2024-03-19 14:44:09,148] [INFO] [utils.py:800:see_memory_usage] Before initializing optimizer states
[2024-03-19 14:44:09,148] [INFO] [utils.py:801:see_memory_usage] MA 4.11 GB         Max_MA 5.13 GB         CA 5.15 GB         Max_CA 5 GB 
[2024-03-19 14:44:09,148] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 10.68 GB, percent = 34.2%
[2024-03-19 14:44:09,224] [INFO] [utils.py:800:see_memory_usage] After initializing optimizer states
/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 12, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
[2024-03-19 14:44:09,224] [INFO] [utils.py:801:see_memory_usage] MA 4.11 GB         Max_MA 6.16 GB         CA 7.2 GB         Max_CA 7 GB 
[2024-03-19 14:44:09,224] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 8.63 GB, percent = 27.7%
[2024-03-19 14:44:09,224] [INFO] [stage_1_and_2.py:539:__init__] optimizer state initialized
[2024-03-19 14:44:09,283] [INFO] [utils.py:800:see_memory_usage] After initializing ZeRO optimizer
[2024-03-19 14:44:09,283] [INFO] [utils.py:801:see_memory_usage] MA 4.11 GB         Max_MA 4.11 GB         CA 7.2 GB         Max_CA 7 GB 
[2024-03-19 14:44:09,284] [INFO] [utils.py:808:see_memory_usage] CPU Virtual Memory:  used = 8.65 GB, percent = 27.7%
[2024-03-19 14:44:09,285] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2024-03-19 14:44:09,285] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupDecayLR
[2024-03-19 14:44:09,285] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupDecayLR object at 0x7f7251e88700>
[2024-03-19 14:44:09,285] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[5e-05], mom=[(0.9, 0.999)]
[2024-03-19 14:44:09,286] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   bfloat16_enabled ............. False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f725208fd00>
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   fp16_auto_cast ............... False
[2024-03-19 14:44:09,286] [INFO] [config.py:1000:print]   fp16_enabled ................. True
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 1
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   gradient_clipping ............ 1.0
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 65536
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   loss_scale ................... 0
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   optimizer_name ............... adam
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   optimizer_params ............. {'lr': 5e-05, 'weight_decay': 0.01}
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   scheduler_name ............... WarmupDecayLR
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   scheduler_params ............. {'total_num_steps': 100000, 'warmup_min_lr': 0, 'warmup_max_lr': 5e-05, 'warmup_num_steps': 0}
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   steps_per_print .............. 100
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   train_batch_size ............. 8
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  4
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   world_size ................... 2
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   zero_enabled ................. True
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-03-19 14:44:09,287] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 2
[2024-03-19 14:44:09,287] [INFO] [config.py:986:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "steps_per_print": 100, 
    "zero_optimization": {
        "stage": 2
    }, 
    "scheduler": {
        "type": "WarmupDecayLR", 
        "params": {
            "total_num_steps": 1.000000e+05, 
            "warmup_min_lr": 0, 
            "warmup_max_lr": 5e-05, 
            "warmup_num_steps": 0
        }
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 5e-05, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true
    }, 
    "gradient_clipping": 1.0, 
    "prescale_gradients": false, 
    "wall_clock_breakdown": false
}
2024-03-19 14:44:09 INFO: [rank0] deepspeed initialize finished.
/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 12, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
[2024-03-19 14:44:11,336] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 4294967296, reducing to 2147483648
2024-03-19 14:44:11 INFO: [rank0] epoch0 step0/304 loss: 1.4794
[2024-03-19 14:44:12,849] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2147483648, reducing to 1073741824
[2024-03-19 14:44:14,343] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 1073741824, reducing to 536870912
2024-03-19 14:44:14 INFO: [rank0] epoch0 step2/304 loss: 1.4198
[2024-03-19 14:44:15,837] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 536870912, reducing to 268435456
[2024-03-19 14:44:17,331] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 268435456, reducing to 134217728
2024-03-19 14:44:17 INFO: [rank0] epoch0 step4/304 loss: 1.4072
[2024-03-19 14:44:18,830] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 134217728, reducing to 67108864
[2024-03-19 14:44:20,336] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 67108864, reducing to 33554432
2024-03-19 14:44:20 INFO: [rank0] epoch0 step6/304 loss: 1.4858
[2024-03-19 14:44:21,842] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 33554432, reducing to 16777216
[2024-03-19 14:44:23,355] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16777216, reducing to 8388608
2024-03-19 14:44:23 INFO: [rank0] epoch0 step8/304 loss: 1.4109
[2024-03-19 14:44:24,874] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 8388608, reducing to 4194304
[2024-03-19 14:44:26,402] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 4194304, reducing to 2097152
2024-03-19 14:44:26 INFO: [rank0] epoch0 step10/304 loss: 1.3620
[2024-03-19 14:44:27,932] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2097152, reducing to 1048576
[2024-03-19 14:44:29,464] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 1048576, reducing to 524288
2024-03-19 14:44:29 INFO: [rank0] epoch0 step12/304 loss: 1.5828
[2024-03-19 14:44:30,996] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 524288, reducing to 262144
[2024-03-19 14:44:32,533] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 262144, reducing to 131072
2024-03-19 14:44:32 INFO: [rank0] epoch0 step14/304 loss: 1.4734
[2024-03-19 14:44:34,066] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 131072, reducing to 65536
[2024-03-19 14:44:35,600] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
2024-03-19 14:44:35 INFO: [rank0] epoch0 step16/304 loss: 1.4933
[2024-03-19 14:44:37,132] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
2024-03-19 14:44:38 INFO: [rank0] epoch0 step18/304 loss: 1.3151
2024-03-19 14:44:41 INFO: [rank0] epoch0 step20/304 loss: 1.9164
2024-03-19 14:44:45 INFO: [rank0] epoch0 step22/304 loss: 1.3651
[2024-03-19 14:44:46,730] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 15438
Traceback (most recent call last):
  File "/home/niwang/code/llm-code/dxm_llm_main.py", line 205, in <module>
    main()
  File "/home/niwang/code/llm-code/dxm_llm_main.py", line 162, in main
    model.step()  # deepspeed更新模型参数
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2169, in step
    self._take_model_step(lr_kwargs)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2075, in _take_model_step
    self.optimizer.step()
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1821, in step
    self.check_overflow()
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 2058, in check_overflow
    self._check_overflow(partition_gradients)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 1972, in _check_overflow
    self.overflow = self.has_overflow(partition_gradients)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 2010, in has_overflow
    overflow = overflow_gpu[0].item()
KeyboardInterrupt
[2024-03-19 14:44:46,819] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 15439
[2024-03-19 14:44:46,875] [INFO] [launch.py:325:sigkill_handler] Main process received SIGINT, exiting
Traceback (most recent call last):
  File "/home/niwang/miniconda3/envs/longqlora/bin/deepspeed", line 6, in <module>
    main()
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/site-packages/deepspeed/launcher/runner.py", line 584, in main
    result.wait()
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/subprocess.py", line 1209, in wait
    return self._wait(timeout=timeout)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/subprocess.py", line 1959, in _wait
    (pid, sts) = self._try_wait(0)
  File "/home/niwang/miniconda3/envs/longqlora/lib/python3.10/subprocess.py", line 1917, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
KeyboardInterrupt
